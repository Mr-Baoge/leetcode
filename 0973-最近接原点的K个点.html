<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<script>
/**
 * @param {number[][]} points
 * @param {number} K
 * @return {number[][]}
 */
// 第一版 直接排序 超出时间限制
// var kClosest = function(points, k) {
//   let res = [];
//   let criticalIndex = 0;
//   points.forEach(item => {
//     res = [...res, item].sort((a, b) => {
//       const [a1, a2] = a;
//       const [b1, b2] = b;
//       return Math.pow(b1, 2) + Math.pow(b2, 2) - (Math.pow(a1, 2) + Math.pow(a2, 2))
//     })
//   })
//   return res.slice(res.length - k);
// };

//  第二版 优先队列  类似插入排序
// var kClosest = function(points, k) {
//   function sqrt(item) {
//     return Math.pow(item[0], 2) + Math.pow(item[1], 2)
//   }
//   function insert(item) {
//     const len = res.length;
//     const value = sqrt(item);
//     let i = len - 2;
//     for (; i >= 0; i--) {
//       if (sqrt(res[i]) > value) {
//         res[i + 1] = res[i];
//       } else {
//         break;
//       }
//     }
//     res[i + 1] = item;
//   }
//
//   let res = [];
//
//   points.forEach(item => {
//     const len = res.length;
//     if (len < k) {
//       res.push(item);
//       insert(item)
//     } else if (len >= k && sqrt(item) < sqrt(res[len - 1])) {
//       res[len - 1] = item;
//       insert(item)
//     }
//   })
//   return res;
// };

// 第三版 借用快排思想
//  如果i === k - 1那么 points.slice(0, i) 就是答案
//  i < k - 1 说明左边全部满足，但是需要加上右边一部分， 只需要对右半部分排序
//  如果 i > k - 1说明左边多了，需要去除一部分，只需要对左半部分排序

var kClosest = function(points, k) {
  if (points.length <= k) {
    return points
  }
  function sqrt(point) {
    return point[0] * point[0] + point[1] * point[1];
  }
  function randomSelect(left, right) {
    const pivot = sqrt(points[right]);
    let i = left;
    let j = left;
   for( ; j < right; j++) {
     if (sqrt(points[j]) < pivot) {
       [points[i], points[j]] = [points[j], points[i]]
       i++;
     }
   }
    [points[i], points[j]] = [points[j], points[i]]
    if (i === k - 1) {
     return points.slice(0, i + 1);
   }
   if (i < k - 1) {
     return randomSelect(i + 1, right);
   }
   if (i > k - 1) {
     return randomSelect(left, i - 1);
   }
  }
  return randomSelect(0, points.length - 1)
};
console.log(kClosest([[1,3],[-2,2],[2,-2]], 2));
// console.log(kClosest([10, 4, 4], 2));
</script>
</body>
</html>
