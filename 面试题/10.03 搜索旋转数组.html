<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<script>
// 搜索旋转数组。给定一个排序后的数组，包含n个整数，但这个数组已被旋转过很多次了，次数不详。
// 请编写代码找出数组中的某个元素，假设数组元素原先是按升序排列的。若有多个相同元素，返回索引值最小的一个。
/**
 * @param {number[]} arr
 * @param {number} target
 * @return {number}
 */
var search = function(arr, target) {
  const len = arr.length;
  let low = 0;
  let high= len - 1;
  while (low < high) {
    const mid = Math.floor(low + (high - low) / 2);
    if (arr[low] < arr[mid]) {    //  前半段有序
      if (arr[low] <= target && target <= arr[mid]) { // target位于前半段
        high = mid;
      } else { // 位于后半段
        low = mid + 1;
      }
    } else if (arr[low] > arr[mid]){    //  后半段有序
      if (arr[mid] >= target || target >= arr[high]) { // target位于前半段
        high = mid;
      } else { // 位于后半段
        low = mid + 1;
      }
    } else if (arr[low] === arr[mid]) {
      if (target === arr[low]) {
        high = low;  // 关键
      } else {
        low++; //关键
      }
    }
  }
  return arr[low] === target ? low : -1;
};

let test1 = [1,1,1,1,1,1,2,1,1];

console.log(search(test1));
</script>
</body>
</html>
